% Marko Ristic

\documentclass[conference]{IEEEtran}

% 
% 8888888 888b     d888 8888888b.   .d88888b.  8888888b. 88888888888 .d8888b.  
%   888   8888b   d8888 888   Y88b d88P" "Y88b 888   Y88b    888    d88P  Y88b 
%   888   88888b.d88888 888    888 888     888 888    888    888    Y88b.      
%   888   888Y88888P888 888   d88P 888     888 888   d88P    888     "Y888b.   
%   888   888 Y888P 888 8888888P"  888     888 8888888P"     888        "Y88b. 
%   888   888  Y8P  888 888        888     888 888 T88b      888          "888 
%   888   888   "   888 888        Y88b. .d88P 888  T88b     888    Y88b  d88P 
% 8888888 888       888 888         "Y88888P"  888   T88b    888     "Y8888P"  
%                                                                              
%                                                                              
%                                                                              
% 

% Graphics
\usepackage{tikz}
\usepackage{graphicx}
% Maths
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathtools}
% Algorithms
\usepackage{algorithm}
\usepackage{algpseudocode}
% Local
\usepackage{ISASmacros/isasmathmacros}
% Equal last columns
%\usepackage{flushend}


% Environments
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

% Algorithm settings
\algnewcommand{\LineComment}[1]{\State \(\triangleright\) #1}

% Tikz settings
\usetikzlibrary{math}

% Tikz reused pics
\tikzset{
   plane/.pic = {
    \draw[fill]  plot[smooth, tension=0.6] coordinates {
        (-0.65,-0.9) 
        (-0.6,-0.85) 
        (-0.4,-0.75) 
        (-0.25,-0.65) 
        (-0.15,-0.5) 
        (-0.12,-0.3) 
        (-0.1,-0.1) 
        (0,0) 
        (0.1,-0.1) 
        (0.12,-0.3) 
        (0.15,-0.5) 
        (0.25,-0.65) 
        (0.4,-0.75) 
        (0.6,-0.85) 
        (0.65,-0.9)
        } -- plot[smooth, tension=0.6] coordinates {
        (0.65,-0.9) 
        (0.15,-0.91)
        (0.35,-1.1) 
        (0.37,-1.15)
        } -- plot[smooth, tension=0.6] coordinates {
        (0.37,-1.15)
        (0,-1.12) 
        (-0.37,-1.15) 
        } -- plot[smooth, tension=0.6] coordinates {
        (-0.37,-1.15)
        (-0.35,-1.1) 
        (-0.15,-0.91) 
        (-0.65,-0.9) 
        } -- cycle;
   }
}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
% paper title
\title{Cryptographically Privileged State Estimation With Gaussian Keystreams}


% author names and affiliations
\author{\IEEEauthorblockN{Marko Ristic}
\IEEEauthorblockA{Intelligent Sensor-Actuator-\\
Systems (ISAS)\\
Karlsruhe Institute of\\
Technology (KIT), Germany\\
Email: marko.ristic@kit.edu\\
Phone: +49 721 608--45250}
\and
\IEEEauthorblockN{Benjamin Noack}
\IEEEauthorblockA{Intelligent Sensor-Actuator-\\
Systems (ISAS)\\
Karlsruhe Institute of\\
Technology (KIT), Germany\\
Email: noack@kit.edu\\
Phone: +49 721 608--44024}
\and
\IEEEauthorblockN{Uwe D. Hanebeck}
\IEEEauthorblockA{Intelligent Sensor-Actuator-\\
Systems (ISAS)\\
Karlsruhe Institute of\\
Technology (KIT), Germany\\
Email: uwe.hanebeck@kit.edu\\
Telephone: +49 721 608--43909}}

% make the title area
\maketitle

% 
%        d8888 888888b.    .d8888b. 88888888888 8888888b.         d8888  .d8888b. 88888888888 
%       d88888 888  "88b  d88P  Y88b    888     888   Y88b       d88888 d88P  Y88b    888     
%      d88P888 888  .88P  Y88b.         888     888    888      d88P888 888    888    888     
%     d88P 888 8888888K.   "Y888b.      888     888   d88P     d88P 888 888           888     
%    d88P  888 888  "Y88b     "Y88b.    888     8888888P"     d88P  888 888           888     
%   d88P   888 888    888       "888    888     888 T88b     d88P   888 888    888    888     
%  d8888888888 888   d88P Y88b  d88P    888     888  T88b   d8888888888 Y88b  d88P    888     
% d88P     888 8888888P"   "Y8888P"     888     888   T88b d88P     888  "Y8888P"     888     
%                                                                                             
%                                                                                             
%                                                                                             
% 

\begin{abstract}
State estimation via public channels requires additional planning with regards to state privacy and the information leakage of involved parties. In some scenarios it is desirable to allow partial leakage of state information, thus distinguishing between privileged and unprivileged estimators and their capabilities. Existing methods identifying privileged and unprivileged or trusted and untrusted estimators typically result in reduced estimation quality for both parties or require additional secure channels of communication. We introduce a method to diminish the estimation quality at unprivileged estimators using a stream of pseudorandom Gaussian samples while leaving privileged estimation unaffected and requiring no additional transmission beyond an initial key exchange. A cryptographic definition of privileged estimation is first presented, capturing the definition of the difference between estimation qualities, before we develop a Gaussian keystream privileged estimation scheme meeting the security criteria defined. Achieving privileged estimation without additional channel requirements allows quantifiable estimation to be made available to the public while keeping the best estimation private to trusted privileged parties and can find uses in a variety of service providing and privacy-preserving scenarios.
\end{abstract}

% no keywords

% For peer review papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

% 
% 8888888 888b    888 88888888888 8888888b.   .d88888b.  
%   888   8888b   888     888     888   Y88b d88P" "Y88b 
%   888   88888b  888     888     888    888 888     888 
%   888   888Y88b 888     888     888   d88P 888     888 
%   888   888 Y88b888     888     8888888P"  888     888 
%   888   888  Y88888     888     888 T88b   888     888 
%   888   888   Y8888     888     888  T88b  Y88b. .d88P 
% 8888888 888    Y888     888     888   T88b  "Y88888P"  
%                                                        
%                                                        
%                                                        
% 

\section{Introduction}
% no \IEEEPARstart
The role of state estimation and sensor data processing has become increasingly prevalent in modern systems []. Since the development of Kalman estimation theory, Bayesian state estimation has found particularly common application, varying from autonomous systems to remote estimation [] and has naturally led to a 

large interest in estimating and reducing the errors associated with state estimates [].

% twice word 'remote' remove one
As advancements in distributed algorithms and cloud computing develop, the use of wireless and public communication channels for data transmission has become widespread [], bringing to light the requirements of data privacy and state secrecy more than ever [].

Typically use-cases for preserving data privacy over public channels has seen sent information encrypted with 




% State estimation

% Wireless and distributed estimation

% Security concerns

% Traditional methods hide all information, other use-cases exist

% Information may be divided into privilege levels authenticating different audiences to different amounts of information [gps, anonymisation]

Our contribution in this work is comprised of a formal definition of privileged state estimation, which allows the quantification of estimation error covariance differences between privileged and unprivileged estimators, before proposing a solution to the problem accompanied by a cryptographic sketch proof and simulation results.

% Section summary
In section \ref{sec:problem_statement} we introduce the relevant privileged estimation problem followed by a cryptographic formalisation of desired properties. Section \ref{sec:priv_estimation} introduces our proposed privileged estimation scheme and in section \ref{sec:security} a cryptographic proof sketch is given. A simulation of the method is then demonstrated and explained in section \ref{sec:simulation}, while concluding remarks and future work are discussed in section \ref{sec:conclusion}.

% 
% ##    ##  #######  ########    ###    ######## ####  #######  ##    ## 
% ###   ## ##     ##    ##      ## ##      ##     ##  ##     ## ###   ## 
% ####  ## ##     ##    ##     ##   ##     ##     ##  ##     ## ####  ## 
% ## ## ## ##     ##    ##    ##     ##    ##     ##  ##     ## ## ## ## 
% ##  #### ##     ##    ##    #########    ##     ##  ##     ## ##  #### 
% ##   ### ##     ##    ##    ##     ##    ##     ##  ##     ## ##   ### 
% ##    ##  #######     ##    ##     ##    ##    ####  #######  ##    ## 
% 

\subsection{Notation}
Throughout this work the following notation is used. Lowercase underlined characters $\vec{a}$ denote vectors, while uppercase bold characters $\mat{M}$ denote matrices. $\mat{M}\succ 0$ and $\mat{M} \succeq 0$ denote positive definitiveness and positive semi-definitiveness, respectively, and $\mat{M} \succ \mat{N}$ is short for $\mat{M}-\mat{N}\succ 0$. Function $\mathsf{eig}(\mat{M})$ gives the set of eigenvalues for matrix $\mat{M}$, $\mathsf{Cov}[\cdot]$ computes the covariance of a random vector, $\mat{I}$ is the identity matrix with context-inferrable size and $\mathsf{negl}(\cdot)$ denotes a negligible function in $\mathbb{N}\rightarrow\mathbb{R}$.
% missing: encryption things, distribution things (not certain these will be required yet)

% 
% 8888888b.  8888888b.   .d88888b.  888888b.   
% 888   Y88b 888   Y88b d88P" "Y88b 888  "88b  
% 888    888 888    888 888     888 888  .88P  
% 888   d88P 888   d88P 888     888 8888888K.  
% 8888888P"  8888888P"  888     888 888  "Y88b 
% 888        888 T88b   888     888 888    888 
% 888        888  T88b  Y88b. .d88P 888   d88P 
% 888        888   T88b  "Y88888P"  8888888P"  
%                                              
%                                              
%                                              
% 

\section{Problem Statement}\label{sec:problem_statement}
The estimation scenario that we consider is for known process and measurement models, where state estimators are either privileged estimators possessing a secret key, or unprivileged estimators without. We aim to develop a scheme for which the difference in their estimation errors is quantifiable and cryptographically guaranteed when process and measurement models are Gaussian, linear and time-invariant.

The process model we consider gives the state $\vec{x}_k\in\mathbb{R}^n$ at a timestep $k$ and is given by
\begin{equation}\label{eqn:linear_process_model}
   \vec{x}_k = \mat{F}\vec{x}_{k-1} + \vec{w}\,,
\end{equation}
with noise term $\vec{w}\sim \mathcal{N}(\vec{0}, \mat{Q})$ and a known covariance $\mat{Q}\in \mathbb{R}^{n\times n}$. Similarly, the measurement model gives the measurement $\vec{y}_k$ at time $k$ and is given by
\begin{equation}\label{eqn:linear_measurement_model}
   \vec{y}_k = \mat{H}\vec{x}_k + \vec{v}\,,
\end{equation}
with noise term $\vec{v}\sim \mathcal{N}(\vec{0}, \mat{R})$ and a known covariance $\mat{R}\in \mathbb{R}^{m\times m}$.

To capture our aim of creating a ``better'' and ``worse'' estimator, we need to define how to assess estimator privilege and what algorithms are required to provide a privileged estimation scheme. In the following section, we give relevant formal definitions, which are later referred to when assessing the security of our proposed scheme.

% 
%  ######  ########  ##    ## ########  ########  #######  
% ##    ## ##     ##  ##  ##  ##     ##    ##    ##     ## 
% ##       ##     ##   ####   ##     ##    ##    ##     ## 
% ##       ########     ##    ########     ##    ##     ## 
% ##       ##   ##      ##    ##           ##    ##     ## 
% ##    ## ##    ##     ##    ##           ##    ##     ## 
%  ######  ##     ##    ##    ##           ##     #######  
% 

\subsection{Formal cryptographic Problem}\label{subsec:crypto_problem}
While we are interested in Gaussian, linear and time-invariant models, it is of more use to define a broader security notion that can be satisfied given specified conditions on the models. This will allow the use of the same notion in future literature and is more closely in-line with cryptography practice. Later, we will show our proposed scheme meets this broad security notion under the Gaussian, linear and time-invariant model assumptions.

Typical formal cryptographic security notions capture desired privacy properties as well as attacker capabilities \cite{katzIntroductionModernCryptography2008}. The most commonly desired privacy property, cryptographic indistinguishability, is not suitable for our estimation scenario due to our desire for unprivileged estimators to still gain \text{some} information from measurements. Instead, we will require a time series of estimation error covariance differences, given arbitrary known Bayesian models, such that the difference in estimation error between estimators with and without the secret key is lower-bounded at all times by the series.

To formalise this, we introduce the following notations and definitions. We assume the existence of an arbitrary process following a known model exactly, with the state at time $k$ denoted $\vec{x}_k\in\mathbb{R}^n$, as in section \ref{sec:problem_statement}, and model parameters $\mathcal{M}_P$. Similarly, we assume the existence of a means of process measurement following a known measurement model exactly, with the measurement at time $k$ denoted as $\vec{y}_k\in\mathbb{R}^m$, and model parameters $\mathcal{M}_M$. We can now define a \textit{privileged estimation scheme} as a pair of algorithms $(\mathsf{Setup},\mathsf{Noise})$ given by
\begin{LaTeXdescription}
   \item[$\mathsf{Setup}(\mathcal{M}_P, \mathcal{M}_M, \kappa)$] On the input of models $\mathcal{M}_P$, $\mathcal{M}_M$ and the security parameter $\kappa$, public parameters $\mathsf{pub}$ and a secret key $\mathsf{sk}$ are created.
   \item[$\mathsf{Noise}(\mathsf{sk}, k, \mathcal{M}_P, \mathcal{M}_M, \vec{y}_1, \dots, \vec{y}_k)$] On input of secret key $\mathsf{sk}$, time $k$, models $\mathcal{M}_P$, $\mathcal{M}_M$ and measaurements $y_1,\dots,y_k$, a noisey measurement $\vec{y}^\prime_k$ (with no required model constraints) is created.
\end{LaTeXdescription}
In addition to the scheme description above, we also give the following definitions to help formalise our desired security notion.
\begin{definition}\label{def:estimator}
   An \textit{estimator} is any algorithm which produces a guess of the state $\vec{x}_k$ for a given time $k$.
\end{definition}
\begin{definition}
   A \textit{negligible covariance function} is a function 
   \begin{equation}
      \mathsf{neglCov}_m(\kappa):\mathbb{N}\rightarrow \mathbb{R}^{m\times m}
   \end{equation}
   that returns a matrix $\mat{A}$ such that $\mat{A}$ is a valid covariance ($\mat{A}\succ 0$ and $\mat{A}=\mat{A}^\top$) and that for each of its eigenvalues $e\in\operatorfont{eig}(\mat{A})$, there exists a negligible function $\eta$ such that $e\leq\eta(\kappa)$.
\end{definition}

With the terminology above, we can now introduce the security notion which captures the formal requirements of the estimation problem we want to solve.
\begin{definition}\label{def:cov_privilege_security_notion}
   A privileged estimation scheme meets \textit{$\{\mat{D}_1,\mat{D}_2,\dots\}$-Covariance Privilege for Models $\mathcal{M}_P$ and $\mathcal{M}_M$} if for any probabilistic polynomial-time (PPT) estimator $\mathcal{A}$, there exists a PPT estimator $\mathcal{A}^\prime$, such that
   \begin{equation}\label{eqn:cov_privilege}
      \begin{split}
         &\operatorfont{Cov}\left[\mathcal{A}\left(k, \kappa, \mathsf{pub}, \mathcal{M}_P, \mathcal{M}_M, \vec{y}^\prime_1,\dots,\vec{y}^\prime_k\right) - \vec{x}_k \right]\\
         &-\operatorfont{Cov}\left[\mathcal{A}^\prime\left(k, \kappa, \mathsf{pub}, \mathcal{M}_P, \mathcal{M}_M, \vec{y}_1,\dots,\vec{y}_k\right) - \vec{x}_k \right]\\
         &\quad\succeq \mat{D}_k + \mathsf{neglCov}_m(\kappa)
      \end{split}
   \end{equation}
   for valid covariances $\mat{D}_1,\dots,\mat{D}_k$ and some negligible covariance for all $k>0$. Here, estimators $\mathcal{A}$ and $\mathcal{A}^\prime$ are running in polynomial-time with respect to the security parameter $\kappa$, and all probabilities are taken over models $\mathcal{M}_P$ and $\mathcal{M}_M$, estimators $\mathcal{A}$ and $\mathcal{A}^\prime$, and algorithms $\mathsf{Setup}$ and $\mathsf{Noise}$.
\end{definition}

Informally, the above definition states that no estimator with access to only noisy measurements $\vec{y}^\prime_1,\dots,\vec{y}^\prime_k$ can estimate a state $\vec{x}_k$ at time $k$ with an RMSE covariance less than an equivalent estimator with normal measurements $\vec{y}_1,\dots,\vec{y}_k$, by a margin of at least $\mat{D}_k$. Next, we will propose a scheme meeting the aforementioned notion for a derivable series of covariances given Gaussian, linear, and time-invariant models $\mathcal{M}_P$ and $\mathcal{M}$.

% 
% 8888888b.  8888888b.  8888888 888     888      8888888888 .d8888b. 88888888888 
% 888   Y88b 888   Y88b   888   888     888      888       d88P  Y88b    888     
% 888    888 888    888   888   888     888      888       Y88b.         888     
% 888   d88P 888   d88P   888   Y88b   d88P      8888888    "Y888b.      888     
% 8888888P"  8888888P"    888    Y88b d88P       888           "Y88b.    888     
% 888        888 T88b     888     Y88o88P        888             "888    888     
% 888        888  T88b    888      Y888P         888       Y88b  d88P    888     
% 888        888   T88b 8888888     Y8P          8888888888 "Y8888P"     888     
%                                                                                
%                                                                                
%                                                                                
% 

\section{Privileged Estimation}\label{sec:priv_estimation}
General idea

(picture ?)

Use a cryptographically secure key stream to generate pseudorandom Gaussian samples

Samples are used to increase the uncertainty of estimation and are known and removable only by those with the key used to generate them

% 
% ##    ## ######## ##    ##  ######  ######## ########  ########    ###    ##     ## 
% ##   ##  ##        ##  ##  ##    ##    ##    ##     ## ##         ## ##   ###   ### 
% ##  ##   ##         ####   ##          ##    ##     ## ##        ##   ##  #### #### 
% #####    ######      ##     ######     ##    ########  ######   ##     ## ## ### ## 
% ##  ##   ##          ##          ##    ##    ##   ##   ##       ######### ##     ## 
% ##   ##  ##          ##    ##    ##    ##    ##    ##  ##       ##     ## ##     ## 
% ##    ## ########    ##     ######     ##    ##     ## ######## ##     ## ##     ## 
% 

\subsection{Gaussian Keystream}
To generate pseudorandom Gaussian samples, we rely on first generating a traditional pseudorandom bitstream given a secret key.

Using well-studied methods for the generation of pseudorandomness guarantees robustness and an easy means of updating only the relevant component when the methods used are no longer considered safe.

Any implementation of a cryptographic stream cipher can be used for our purpose and will produce a stream of bits typically combined with plaintexts to provide secure encryption.

Rather than encrypting plaintext, we interpret the bitstream as sequential pseudorandom integers $g$ and use these to generate pseudorandom uniform real numbers in the range (0,1). $u$

While the uniform real samples are only approximated by floating-point numbers in the conversion from integers, we argue this is sufficiently random and discuss this further in the Security section.

Finally, independent standard Gaussian samples can then be generated from the uniform real numbers using the Box-Muller transform, and are ready to be used by our sensor and privileged filter. $z$

% 
%    ###    ########  ########     ##    ##  #######  ####  ######  ######## 
%   ## ##   ##     ## ##     ##    ###   ## ##     ##  ##  ##    ## ##       
%  ##   ##  ##     ## ##     ##    ####  ## ##     ##  ##  ##       ##       
% ##     ## ##     ## ##     ##    ## ## ## ##     ##  ##   ######  ######   
% ######### ##     ## ##     ##    ##  #### ##     ##  ##        ## ##       
% ##     ## ##     ## ##     ##    ##   ### ##     ##  ##  ##    ## ##       
% ##     ## ########  ########     ##    ##  #######  ####  ######  ######## 
% 

\subsection{Additional Gaussian Noise}
To use the pseudorandom Gaussian samples at the sensor and privileged estimator, they need to be converted to multivariate Gaussian samples suitable for use in the measurement model and need a means of controlling how much uncertainty is added to the unprivileged estimators.

We define the additional noise term $Z>0$ and can transform the Gaussian samples $z$ into pseudorandom samples $o$ of a multivariate zero-mean Gaussian distribution with covariance $Z$.

Before estimation, we assume that a secret key is shared between the sensor and the privileged estimator.

During estimation, the sensor modifies its measurements at each timestep.

There are now two estimation problems present for the privileged and unprivileged estimators respectively.

For the privileged estimator who holds the shared secret key, values $z$, and therefore $o$, can be computed at any time $k$ and received measurements modified to their original form. This in turn results in exactly the measurement model from the problem formulation.

In the case where pseudorandomness is indistinguishable from randomness, as is the case at an unprivileged estimator when using cryptographically secure Gaussian keystreams and the secret key is not known, the measurement model noise covariance can now be written as $R+Z$.

Intuitively, we can already see that the two estimators will have an estimation error covariance differing by some value dependent on $Z$ at each time $k$. In the security section, we will show that the best possible error covariances achievable by the privileged and unprivileged estimators can be computed exactly by computing the Cramér–Rao lower-bound for both measurement models and that the difference between them will give an exact lower-bound on the difference between the two estimator error covariances.

% 
% ##     ## ##     ## ##       ########    ########  ########  #### ##     ## 
% ###   ### ##     ## ##          ##       ##     ## ##     ##  ##  ##     ## 
% #### #### ##     ## ##          ##       ##     ## ##     ##  ##  ##     ## 
% ## ### ## ##     ## ##          ##       ########  ########   ##  ##     ## 
% ##     ## ##     ## ##          ##       ##        ##   ##    ##   ##   ##  
% ##     ## ##     ## ##          ##       ##        ##    ##   ##    ## ##   
% ##     ##  #######  ########    ##       ##        ##     ## ####    ###    
% 

\subsection{Multiple Privileges}
In the above scenario, we have considered a single level of estimation privileged with one private key, dividing estimation error covariance into two groups; privileged and unprivileged estimators.

As a direct extension, it may be desirable to define multiple levels of privilege, such that the best estimation performance would depend on the privilege level of the estimator.

Here we will discuss the case of multiple privilege levels where a single secret key corresponds to each level, and where noise is added in the same manner as above, for each key individually.

$N$ noise terms are added to the original measurement equation, with variances $Z_i$, $0 \leq i < N$.

From the equation, we can see that obtaining any single key $\mathsf{sk}_i$ would lead to a measurement model where only a single pseudorandom Gaussian noise sample, of variance $Z_i$, is removed.

This restricts possible estimation error bounds of each privilege level due to the dependence of measurement noise at an estimator with key $\mathsf{sk}_i$, on the remaining noise terms $Z_j,j \neq i$.

If we write the covariances of added measurement model noise for holder of each key $\mathsf{sk}_i$ as $E_i$, we can capture this dependance as $E_i=\sum^{N-1}_{j=0,j \neq i}Z_j$ where both $E_i>0$ and $Z_i>0$.

Since choosing values $E_i$ directly controls the estimation error differences between privileged levels, we are interested in the numerical restrictions on $E_i>0$ which will produce valid covariances $Z_j>0$, that can be used when adding noise at the sensor.

The dependencies between the covariances can be captured by the block matrix equation.

...equation and also block matrix inequality (might need some defining as it uses $\prec$)

Since we require $Z_i>0$ for all $0 \leq i < N$, the restriction on the choices of privilege level additional noises $E_i$ can be rewritten as
\begin{equation}
   E_i \prec \frac{1}{N-2}\sum_{i=0}^{N-1}E_i
\end{equation}
for all $0 \leq i < N$.

Alternative methods involving multiple or overlapping keys among privilege levels may allow choices of $E_i$ to be less restricted than in the equation above. We have chosen the case with a single shared key per privilege level due to its simplicity and ability to change privilege estimation performance without needing additional key redistribution, and leave variants with fewer restrictions than () as future work.

% 
%  .d8888b.  8888888888 .d8888b.  888     888 8888888b.  8888888 88888888888 Y88b   d88P 
% d88P  Y88b 888       d88P  Y88b 888     888 888   Y88b   888       888      Y88b d88P  
% Y88b.      888       888    888 888     888 888    888   888       888       Y88o88P   
%  "Y888b.   8888888   888        888     888 888   d88P   888       888        Y888P    
%     "Y88b. 888       888        888     888 8888888P"    888       888         888     
%       "888 888       888    888 888     888 888 T88b     888       888         888     
% Y88b  d88P 888       Y88b  d88P Y88b. .d88P 888  T88b    888       888         888     
%  "Y8888P"  8888888888 "Y8888P"   "Y88888P"  888   T88b 8888888     888         888     
%                                                                                        
%                                                                                        
%                                                                                        
% 

\section{Scheme Security}\label{sec:security}
The security of the proposed scheme will be primarily considered in the single privileged estimation level as introduced in section ().

A proof sketch will be provided to show how the proposed scheme meets the cryptographic notion in section ().

The extension to multiple privilege levels as described in the section () will be informally discussed afterwards.

% 
%  ######  #### ##    ##  ######   ##       ######## 
% ##    ##  ##  ###   ## ##    ##  ##       ##       
% ##        ##  ####  ## ##        ##       ##       
%  ######   ##  ## ## ## ##   #### ##       ######   
%       ##  ##  ##  #### ##    ##  ##       ##       
% ##    ##  ##  ##   ### ##    ##  ##       ##       
%  ######  #### ##    ##  ######   ######## ######## 
% 

\subsection{Single Privileged Case}
Recalling the introduced security notion in section \eqref{eqn:linear_measurement_model}, we aim to show how our introduce privileged esitmation scheme, given conditions on $\mathcal{M}_P$ and $\mathcal{M}_M$, meets the desired security for a computable series $\mat{D}_1,\dots,\mat{D}_k$ dependent on the additional noise variable $Z$.

We consider the process model \eqref{eqn:linear_process_model} and measurement model \eqref{eqn:linear_measurement_model} exactly, that is, any linear models with known zero-mean Gaussian additive noises. This information is captured in $\mathcal{M}_P$ and $\mathcal{M}_M$ and defines our conditions on the models.

The two required algorithms for the privileged estimation scheme, $\mathsf{Setup}$ and $\mathsf{Noise}$, are defined such that $\mathsf{Setup}$ initialises the stream cipher with security parameter $\kappa$, sets the secret key $\mathsf{sk}$ to that of the cipher and includes initial filter estimate $\hat{\vec{x}}_0$, error covariance $\mat{P}_0$ and additional noise variance $\mat{Z}$ in the public parameters $\mathsf{pub}$.

% point this out - is this even needed? Can we ignore the init states? (how does this reflect on the security definition)
Here we note that including the initial state, error covariance and added noise variance is not a requirement for the security of our scheme, but rather just a means of making relevant estimation parameters public for completeness.

The $\mathsf{Noise}$ function is then given by () where $\vec{y}^\prime_k$ is the measurement after adding a pseudorandom Gaussian sample using the stream cipher at time $k$.

The idea behind the proof relies on the Cramér–Rao lower bound (CRLB). The CRLB gives the smallest error covariance, with respect to root mean square error (RMSE), achievable for \textit{any} estimator when all measurements $\vec{y}_1,\dots,\vec{y}_k$ are observed []. Notably, the CRLB can be computed exactly when process and measurement models are linear and Gaussian.

The CRLB can also be computed recursively for time $k$, in which case it reduces to the posterior estimate error covariance at time $k$ as given by the linear Kalman Filter []. This is given by

...recursive equations for the update covariance of the KF (predict and update combined, but predict first). (Note is this true?? Might need biased CRLB - when is it the best?? What assumptions are made??)

which gives us a value $\mat{P}_k$ at time $k$, such that
\begin{equation}
   \mat{P}_k \preceq \operatorfont{Cov}\left[\mathcal{A}\left(k, \mathcal{M}_P, \mathcal{M}_M, \vec{y}_1,\dots,\vec{y}_k\right) - \vec{x}_k \right]
\end{equation}
for any estimator $\mathcal{A}$ following definition \ref{def:estimator} and any Gaussian, linear, time-invariant models $\mathcal{M}_P$ and $\mathcal{M}_M$.

This leads us into our sketch proof.

Proof sketch: (LaTeXdescription? sub(sub)section?)

As we use a cryptographically pseudorandom stream cipher, the stream integers $g$ and generated pseudorandom uniformly distributed floating point numbers $u$ are indistinguishable from random integers and floating-point number by any polynomially bound estimator. 

% How to state this sentence nicer? Technically would affect the security definition so needs to be here.
Additionally, we argue that the uniformly distributed floating point numbers $u$ are sufficiently close to real standard uniform numbers $\mathcal{U}(0,1)$ for all the necessary estimation properties and lower bounds to hold. This is the standard in estimation tasks due to the inexistence of true real numbers on modern computer hardware.

In turn, this leads to pseudorandom noisy measurements $\vec{y}^\prime_k$ that are indistinguishable from real measurements following the noisy measurement model () exactly.

We can now compute the CRLB recursively for both the true measurement model (), obtaining series $\{\mat{P}_1,\mat{P}_2,\dots\}$, and the modified model (), obtaining series $\{\mat{P}^\prime_1,\mat{P}^\prime_2,\dots\}$. Due to models' properties $R<R+Z$, and the properties of the CRLB, taking the difference of the two series for \textit{any} initial covariance $\mat{P}_0$ produces the infinite series of valid covariances $\mat{D}_1,\mat{D}_2,\dots$, where
\begin{equation}
   \mat{D}_k = \mat{P}^\prime_k - \mat{P}_k\,.
\end{equation}

Since both series $\mat{P}_k$ and $\mat{P}^\prime_k$ give the lowest possible error covariance of respective estimators, an estimator following model () can always be created for an estimator following the modified model () such that their error covariances at any time $k$ differs by at least $\mat{D}_k$.

A reduction proof can be easily constructed where the existence of an unprivileged estimator in our scheme that can produce estimates such that \eqref{eqn:cov_privilege} does not hold, can be used to construct an estimator with an error covariance lower than $\mat{P}^\prime_k$ given the modified model. As we know that no such estimator exists, we conclude that our scheme meets $\{\mat{D}_1,\mat{D}_2,\dots\}$-Covariance Privilege for Models $\mathcal{M}_P$ and $\mathcal{M}_M$, when $\mathcal{M}_P$ and $\mathcal{M}_M$ are Gaussian, linear and time-invariant.

End proof sketch.

In addition to the proof sketch above, we stress caution when assuming accepting a cryptographic guarantee in terms of models $\mathcal{M}_P$ and $\mathcal{M}_M$ when used to predict a measured physical process. The following implicit assumptions would be made in such a scenario.
\begin{LaTeXdescription}
   \item[Exact models] When assigning a model to a physical process, our scheme involving the model only guarantees the same security of estimating the physical process when it follows the model \textit{exactly}. It is often the case that models are chosen to be Gaussian and linear in part to simplify estimation, resulting in the possibility of better estimation with alternative, more complicated, models. While it may be likely that the estimation of an unprivileged estimator is worse even when this is the case, it cannot be proved by our methodology here.
   \item[Bayesian interpretation] We also note that the model requirements and security definitions we have put forward assume a Bayesian interpretation of probability theory. Although this is the standard for state estimation problems due to its applicability and performance, without stating this assumption it may be arguable that the security definition \ref{eqn:cov_privilege} may not hold.
\end{LaTeXdescription}

% 
% ##     ## ##     ## ##       ######## 
% ###   ### ##     ## ##          ##    
% #### #### ##     ## ##          ##    
% ## ### ## ##     ## ##          ##    
% ##     ## ##     ## ##          ##    
% ##     ## ##     ## ##          ##    
% ##     ##  #######  ########    ##    
% 

\subsection{Multiple Additional Noises}
While we have not defined a security notion for multiple levels of privileged estimation, an intuitive and informal extension can be described.

The security notion desired would require that for any subset of corrupted estimators, and therefore the knowledge of any subset of different privilege level secret keys $s \subset \{\mathsf{sk}_i,\,0 \leq i < N\}$ and noisy measurements, an estimator which is given true measurements can be constructed, such that the difference between the corrupted subset's error covariance and its own is at least $\mat{D}^{(s)}_k$ at time $k$.

Although this definition requires an infinite series for every possible subset of privilege level keys $s$, complicating its form specification, it captures the exact advantage of every such subset making it a more general definition.

Given the structure of our scheme in section () it can be readily seen how the above notion would be met. Similarly to the single level case, the CRLB can be used to compute the minimum error covariances for all compromised key subsets as well as for an estimator with the true measurements, and the relevant infinite covariance series' can be defined.

% 
%  .d8888b. 8888888 888b     d888 
% d88P  Y88b  888   8888b   d8888 
% Y88b.       888   88888b.d88888 
%  "Y888b.    888   888Y88888P888 
%     "Y88b.  888   888 Y888P 888 
%       "888  888   888  Y8P  888 
% Y88b  d88P  888   888   "   888 
%  "Y8888P" 8888888 888       888 
%                                 
%                                 
%                                 
% 

\section{Simulation and Results}\label{sec:simulation}
As well as showing the theoretical security of our scheme, we have simulated the estimation problem using linear Kalman filter estimators which achieve the CRLB error covariances for the different measurement models. Simulations have been implemented in the Python programming language and use the AES block cipher in CTR mode as a cryptographically secure stream cipher (AES-CTR) [].

We have considered two simulations, both following the same two-dimensional constant-velocity process model, given by
\begin{equation*}
   \mat{F}=
   \begin{bmatrix}
      1 & 0.5 & 0 & 0\\
      0 & 1 & 0 & 0\\
      0 & 0 & 1 & 0.5\\
      0 & 0 & 0 & 1
   \end{bmatrix}
\end{equation*}
and
\begin{equation*}
   \mat{Q}=0.01\cdot
   \begin{bmatrix}
      0.0417 & 0.1250 & 0 & 0\\
      0.1250 & 0.5000 & 0 & 0\\
      0 & 0 & 0.0417 & 0.1250\\
      0 & 0 & 0.1250 & 0.5000
   \end{bmatrix}\,,
\end{equation*}
with differing measurement models. In all cases, estimators were initialised with the same initial conditions, equal to the true starting condition of the processes they were estimating.

The first measurement model measures location and leads to an observable system with bounded CRLB error covariances as $k \rightarrow \infty$. It is given by
\begin{equation*}
   \mat{H}=
   \begin{bmatrix}
      1 & 0 & 0 & 0\\
      0 & 0 & 1 & 0
   \end{bmatrix}
   \text{ and }
   \mat{R}=
   \begin{bmatrix}
      5 & 2\\
      2 & 5
   \end{bmatrix}\,,
\end{equation*}
and the sensor adds pseudorandom Gaussian samples with covariance
\begin{equation*}
   \mat{Z}=
   \begin{bmatrix}
      35 & 0\\
      0 & 35
   \end{bmatrix}
\end{equation*}
to create an estimator privilege level. Figures () and () show the average error covariance traces and RMSE of estimation from 1000 runs of our privileged estimation scheme, respectively, where the above models are followed. It can be seen that the trace of the privileged estimator error covariance is lower than that of the unprivileged one. Both traces are equivalent to the those of respective estimator CRLB covariances and their difference equal to the trace of the estimation privilege covariance $\mat{D}_k$ at any time $k$.

% Figure one <here>

The second simulation considers an unobservable system where only the velocity is measured and has an unbounded CRLB error covariance as $k \rightarrow \infty$. It is given by
\begin{equation*}
   \mat{H}=
   \begin{bmatrix}
      0 & 1 & 0 & 0\\
      0 & 0 & 0 & 1
   \end{bmatrix}
\end{equation*}
and uses the same values for $\mat{R}$ and $\mat{Z}$ as given for the previous model. Figures () and () show the average error covariance traces and RMSE of estimation from 1000 runs using this model and capture how error covariance boundedness does not affect the privileged estimation scheme's properties.

% Figure two <here>

Lastly, a simulation of multiple privilege levels was also performed using the bounded error covariance measurement model () and using pseudorandom Gaussian sample with variances $\mat{Z}_0=20 \cdot \mat{I}$, $\mat{Z}_1=14 \cdot \mat{I}$ and $\mat{Z}_2=17 \cdot \mat{I}$. Note that the three matrices $\mat{Z}_i$, $0 \leq i < 3$ are such that () is satisfied. Figures () and () again show the average traces and RMSE of estimation from 1000 runs and display the distinct difference in estimation error of the different privilege levels. Additionally, two special case bounding estimators are included, one holding all privilege level keys and one holding none.

% Figure three <here>

All of the included figures capture the difference in estimation error of the best possible estimators given the simulated processes (with respect to RMSE) and support the proposed security proof sketch given in section ().

% 
%  .d8888b.   .d88888b.  888b    888  .d8888b.  
% d88P  Y88b d88P" "Y88b 8888b   888 d88P  Y88b 
% 888    888 888     888 88888b  888 888    888 
% 888        888     888 888Y88b 888 888        
% 888        888     888 888 Y88b888 888        
% 888    888 888     888 888  Y88888 888    888 
% Y88b  d88P Y88b. .d88P 888   Y8888 Y88b  d88P 
%  "Y8888P"   "Y88888P"  888    Y888  "Y8888P"  
%                                               
%                                               
%                                               
% 

\section{Conclusion}\label{sec:conclusion}
Presented the idea of privileged estimation and gave a formal cryptographic definition.

Demonstrated a concrete privileged estimation scheme and gave a proof sketch for it meeting the desired security notion.

Additionally supported the proof sketch by simulation using the best possible estimators for the simulated processes.

Future work includes reducing the requirement () for multiple levels of private estimation, discussing the formal security in this case further and implementing privileged estimation on hardware to demonstrate the real-time capability of the method.

% conference papers do not normally have an appendix

% use section* for acknowledgment
\section*{Acknowledgment}
The authors would like to thank...

% Bibliography
\bibliographystyle{IEEEtran}
\bibliography{BibTeX/PrivilegedEstimation}

% that's all folks
\end{document}


